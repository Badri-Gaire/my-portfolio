---
import { menuLinks } from "../../utils/siteConfig";
// import ThemeToggle from "../shared/ThemeToggle.astro";
---

<header
  class="fixed top-0 left-0 w-full z-50 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg lg:border-b lg:border-gray-100 dark:border-gray-800"
>
  <div class="container mx-auto px-4 py-4 flex justify-between items-center">
    <a href="/" class="text-xl font-bold z-50 relative">
      <svg
        width="110"
        height="32"
        viewBox="0 0 110 32"
        xmlns="http://www.w3.org/2000/svg"
      >
        <text
          x="0"
          y="24"
          font-size="24"
          font-weight="800"
          fill="currentColor"
          font-family="Inter, system-ui, -apple-system, sans-serif"
          letter-spacing="-0.5"
        >
          Badri
        </text>
      </svg></a
    >

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex gap-6 items-center">
      {
        menuLinks.map((link) => (
          <a
            href={link.path}
            class="hover:text-primary transition-colors text-sm font-medium"
          >
            {link.title}
          </a>
        ))
      }
      <!-- <ThemeToggle /> -->
    </nav>

    <!-- Mobile Navigation Controls -->
    <div class="flex items-center gap-4 md:hidden">
      <!-- <ThemeToggle /> -->
      <button
        id="menu-toggle"
        class="relative z-50 p-2 -mr-2 text-gray-600 dark:text-gray-300 hover:text-primary transition-colors focus:outline-none"
        aria-label="Toggle Menu"
      >
        <div id="menu-icon-open" class="block">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="size-6"
            ><line x1="4" x2="20" y1="12" y2="12"></line><line
              x1="4"
              x2="20"
              y1="6"
              y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg
          >
        </div>
        <div id="menu-icon-close" class="hidden">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="size-6"
            ><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg
          >
        </div>
      </button>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu"
    class="fixed inset-x-0 top-15 bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800 shadow-xl md:hidden opacity-0 invisible"
  >
    <nav class="container mx-auto px-4 py-6 flex flex-col gap-4">
      {
        menuLinks.map((link) => (
          <a
            href={link.path}
            class="mobile-link text-lg font-medium text-gray-600 dark:text-gray-300 hover:text-primary py-2 border-b border-gray-50 dark:border-gray-800 last:border-none"
          >
            {link.title}
          </a>
        ))
      }
    </nav>
  </div>
</header>

<!-- Spacer for fixed header -->
<div class="h-15"></div>

<script>
  const menuToggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const iconOpen = document.getElementById("menu-icon-open");
  const iconClose = document.getElementById("menu-icon-close");
  const mobileLinks = document.querySelectorAll(".mobile-link");

  let isMenuOpen = false;

  const toggleMenu = async () => {
    const { gsap } = await import("gsap");
    isMenuOpen = !isMenuOpen;

    if (isMenuOpen) {
      // Open Menu
      iconOpen?.classList.add("hidden");
      iconClose?.classList.remove("hidden");

      gsap.to(mobileMenu, {
        duration: 0.3,
        autoAlpha: 1,
        y: 0,
        ease: "power2.out",
        display: "block",
      });

      gsap.fromTo(
        mobileLinks,
        { y: -10, opacity: 0 },
        {
          y: 0,
          opacity: 1,
          stagger: 0.05,
          duration: 0.3,
          delay: 0.1,
        },
      );
    } else {
      // Close Menu
      iconOpen?.classList.remove("hidden");
      iconClose?.classList.add("hidden");

      gsap.to(mobileMenu, {
        duration: 0.2,
        autoAlpha: 0,
        y: -10,
        ease: "power2.in",
      });
    }
  };

  menuToggle?.addEventListener("click", toggleMenu);

  mobileLinks.forEach((link) => {
    link.addEventListener("click", () => {
      if (isMenuOpen) toggleMenu();
    });
  });

  window.addEventListener("resize", () => {
    if (window.innerWidth >= 768 && isMenuOpen) {
      toggleMenu();
    }
  });
</script>
